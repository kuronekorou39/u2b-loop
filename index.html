<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#e94560">
    <meta name="description" content="YouTube & Local Video A-B Loop Player">
    <!-- OGP -->
    <meta property="og:title" content="U2B-Loop">
    <meta property="og:description" content="YouTube„Éª„É≠„Éº„Ç´„É´ÂãïÁîª„ÅÆABÂå∫Èñì„É´„Éº„ÉóÂÜçÁîü„Éó„É¨„Éº„É§„Éº">
    <meta property="og:image" content="https://kuronekorou39.github.io/u2b-loop/assets/logo-readme.png">
    <meta property="og:url" content="https://kuronekorou39.github.io/u2b-loop/">
    <meta property="og:type" content="website">
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <title>U2B-Loop</title>
    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" href="assets/favicon.png" type="image/png">
    <link rel="apple-touch-icon" href="assets/icon-512.png">
</head>
<body>
    <div class="container">
        <!-- „Éò„ÉÉ„ÉÄ„ÉºÔºà„Çø„Ç§„Éà„É´ + „É¨„Ç§„Ç¢„Ç¶„ÉàÂàáÊõø + URLÂÖ•Âäõ„Éà„Ç∞„É´Ôºâ -->
        <header class="header">
            <div class="logo-group">
                <a href="./" class="logo-link">
                    <img src="assets/logo.png" alt="U2B-Loop" class="header-logo">
                </a>
                <span id="appVersion" class="version"></span>
                <span id="versionStatus" class="version-status"></span>
                <a href="#" id="updateLink" class="update-link" style="display: none;">Êõ¥Êñ∞„ÅÇ„Çä</a>
            </div>
            <div class="header-buttons">
                <button id="toggleUrlBtn" class="header-toggle show" title="ÂãïÁîª„ÇíË™≠„ÅøËæº„ÇÄ">
                    <span class="toggle-text">Ë™≠Ëæº</span>
                    <span class="toggle-arrow">‚ñº</span>
                </button>
                <button id="layoutBtn" class="header-btn" title="„É¨„Ç§„Ç¢„Ç¶„ÉàÂàáÊõø">
                    <span class="btn-icon">‚äü</span><span class="btn-label">‰∏¶Êõø</span>
                </button>
                <button id="historyBtn" class="header-btn" title="Â±•Ê≠¥">
                    <span class="btn-icon">‚ó∑</span><span class="btn-label">Â±•Ê≠¥</span>
                </button>
                <button id="themeBtn" class="header-btn" title="„ÉÜ„Éº„ÉûÂàáÊõø">
                    <span class="btn-icon">‚òÄ</span><span class="btn-label">Ëâ≤</span>
                </button>
                <!-- „Ç∑„Éß„Éº„Éà„Ç´„ÉÉ„ÉàÔºàÁ∏¶‰∏¶„Å≥ÊôÇÔºö„Éò„ÉÉ„ÉÄ„Éº„Å´Ë°®Á§∫Ôºâ -->
                <div class="shortcut-accordion shortcut-in-header">
                    <button id="shortcutAccordionBtn" class="header-btn shortcut-accordion-btn" title="„Ç≠„Éº„Éú„Éº„Éâ„Ç∑„Éß„Éº„Éà„Ç´„ÉÉ„Éà‰∏ÄË¶ß">
                        <span class="btn-icon">‚å®</span><span class="btn-label">Keys</span>
                    </button>
                    <div id="shortcutAccordionContent" class="shortcut-accordion-content">
                        <div class="shortcut-list-compact">
                            <div class="shortcut-item"><kbd>Space</kbd><span>ÂÜçÁîü</span></div>
                            <div class="shortcut-item"><kbd>‚Üê‚Üí</kbd><span>5Áßí</span></div>
                            <div class="shortcut-item"><kbd>A</kbd><span>AÂú∞ÁÇπ</span></div>
                            <div class="shortcut-item"><kbd>B</kbd><span>BÂú∞ÁÇπ</span></div>
                            <div class="shortcut-item"><kbd>L</kbd><span>„É´„Éº„Éó</span></div>
                            <div class="shortcut-item"><kbd>R</kbd><span>„É™„Çª„ÉÉ„Éà</span></div>
                            <div class="shortcut-item"><kbd>M</kbd><span>„Éü„É•„Éº„Éà</span></div>
                            <div class="shortcut-item"><kbd>F</kbd><span>ÂÖ®ÁîªÈù¢</span></div>
                            <div class="shortcut-item"><kbd>H</kbd><span>Â∑¶Âè≥ÂèçËª¢</span></div>
                            <div class="shortcut-item"><kbd>V</kbd><span>‰∏ä‰∏ãÂèçËª¢</span></div>
                        </div>
                    </div>
                </div>
                <button id="helpBtn" class="header-btn help-btn" title="‰Ωø„ÅÑÊñπ">
                    <span class="btn-icon">?</span>
                </button>
            </div>
        </header>

        <!-- ÂãïÁîªË™≠„ÅøËæº„ÅøÔºàÊäò„Çä„Åü„Åü„ÅøÔºâ -->
        <div id="urlSection" class="url-section show">
            <!-- YouTube -->
            <div class="source-row">
                <input type="text" id="videoUrl" placeholder="YouTube URL„ÇíË≤º„Çä‰ªò„Åë">
                <button id="loadBtn" class="load-btn">Ë™≠Ëæº</button>
            </div>

            <div class="source-divider"><span>„Åæ„Åü„ÅØ</span></div>

            <!-- „É≠„Éº„Ç´„É´„Éï„Ç°„Ç§„É´ -->
            <div class="source-row">
                <label class="file-input-label">
                    <span id="fileNameDisplay">„Éï„Ç°„Ç§„É´„ÇíÈÅ∏Êäû...</span>
                    <input type="file" id="localFileInput" accept="video/*" hidden>
                </label>
                <button id="loadFileBtn" class="load-btn">Ë™≠Ëæº</button>
            </div>
        </div>

        <!-- „É°„Ç§„É≥„Ç≥„É≥„ÉÜ„É≥„ÉÑÔºàÊ®™‰∏¶„Å≥ÂØæÂøúÔºâ -->
        <div class="main-content">
            <!-- Â∑¶„Éë„Éç„É´: ÂãïÁîª + „Ç≥„É≥„Éà„É≠„Éº„É´ -->
            <div class="left-panel">
                <!-- ÂãïÁîª„Éó„É¨„Éº„É§„Éº + „Ç™„Éº„Éê„Éº„É¨„Ç§„Ç≥„É≥„Éà„É≠„Éº„É©„Éº -->
                <div class="player-wrapper" id="playerWrapper">
                    <div id="playerContainer" class="player-container">
                        <div id="player"></div>
                        <video id="localVideo" playsinline webkit-playsinline style="display: none;"></video>
                    </div>

                    <!-- „Éâ„É©„ÉÉ„Ç∞&„Éâ„É≠„ÉÉ„Éó„Ç™„Éº„Éê„Éº„É¨„Ç§ -->
                    <div id="dropZone" class="drop-zone">
                        <div class="drop-zone-content">
                            <span class="drop-icon">‚ñº</span>
                            <span class="drop-text">„Éï„Ç°„Ç§„É´„Çí„Éâ„É≠„ÉÉ„Éó</span>
                        </div>
                    </div>

                    <!-- „Ç™„Éº„Éê„Éº„É¨„Ç§„Ç≥„É≥„Éà„É≠„Éº„É©„ÉºÔºà„Éï„É´„Çπ„ÇØ„É™„Éº„É≥ÊôÇÔºâ -->
                    <div class="overlay-controls" id="overlayControls">
                        <div class="overlay-gradient"></div>
                        <div class="overlay-content">
                            <!-- „Ç∑„Éº„ÇØ„Éê„Éº -->
                            <div class="overlay-seekbar">
                                <span id="overlayCurrentTime" class="overlay-time">0:00</span>
                                <div class="overlay-seekbar-wrapper">
                                    <div id="overlayABRegion" class="overlay-ab-region"></div>
                                    <input type="range" id="overlaySeekbar" class="overlay-seekbar-input" min="0" max="100" value="0" step="0.1">
                                </div>
                                <span id="overlayDuration" class="overlay-time">0:00</span>
                            </div>
                            <!-- „Éú„Çø„É≥È°û -->
                            <div class="overlay-buttons">
                                <button id="overlayPlayPauseBtn" class="overlay-btn play">‚ñ∂</button>
                                <button id="overlayMuteBtn" class="overlay-btn muted">üîá</button>
                                <select id="overlaySpeedSelect" class="overlay-select">
                                    <option value="0.25">0.25x</option>
                                    <option value="0.5">0.5x</option>
                                    <option value="0.75">0.75x</option>
                                    <option value="1" selected>1x</option>
                                    <option value="1.25">1.25x</option>
                                    <option value="1.5">1.5x</option>
                                    <option value="1.75">1.75x</option>
                                    <option value="2">2x</option>
                                </select>
                                <button id="overlayLoopBtn" class="overlay-btn">‚Üª OFF</button>
                                <button id="overlayExitBtn" class="overlay-btn exit">‚úï</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- „É°„Ç§„É≥„Ç∑„Éº„ÇØ„Éê„Éº + ÊôÇÈñì -->
                <div class="seekbar-section">
                    <span id="currentTime">0:00</span>
                    <div class="seekbar-wrapper">
                        <div id="seekbarABRegion" class="seekbar-ab-region"></div>
                        <input type="range" id="seekbar" min="0" max="100" value="0" step="0.1">
                    </div>
                    <span id="duration">0:00</span>
                </div>

                <!-- „Ç≥„É≥„Éà„É≠„Éº„É´Ë°åÔºöÂÜçÁîü + ÈÄüÂ∫¶ + „Éü„É•„Éº„Éà + ÂèçËª¢ -->
                <div class="controls-row">
                    <button id="playPauseBtn" class="play-btn" title="ÂÜçÁîü/‰∏ÄÊôÇÂÅúÊ≠¢ (Space)">‚ñ∂</button>
                    <select id="speedSelect" title="ÂÜçÁîüÈÄüÂ∫¶">
                        <option value="0.25">0.25x</option>
                        <option value="0.5">0.5x</option>
                        <option value="0.75">0.75x</option>
                        <option value="1" selected>1x</option>
                        <option value="1.25">1.25x</option>
                        <option value="1.5">1.5x</option>
                        <option value="1.75">1.75x</option>
                        <option value="2">2x</option>
                    </select>
                    <button id="muteBtn" class="mute-btn muted" title="„Éü„É•„Éº„Éà (M)">üîá</button>
                    <div class="flip-buttons">
                        <button id="flipHorizontalBtn" class="flip-btn" title="Â∑¶Âè≥ÂèçËª¢ (H)">‚áÑ</button>
                        <button id="flipVerticalBtn" class="flip-btn" title="‰∏ä‰∏ãÂèçËª¢ (V)">‚áÖ</button>
                    </div>
                    <button id="fullscreenBtn" class="fullscreen-btn" title="„Éï„É´„Çπ„ÇØ„É™„Éº„É≥ (F)">‚õ∂</button>
                    <button id="pipBtn" class="pip-btn" title="„Éî„ÇØ„ÉÅ„É£„Ç§„É≥„Éî„ÇØ„ÉÅ„É£ (P)" style="display: none;">‚ßâ</button>
                    <button id="ytControlsBtn" class="yt-controls-btn" title="YT„Ç≥„É≥„Éà„É≠„Éº„É©„ÉºË°®Á§∫" style="display: none;">‚öô</button>
                </div>
            </div>

            <!-- Âè≥„Éë„Éç„É´: A-BÂå∫Èñì„É´„Éº„Éó -->
            <div class="right-panel">
                <div class="loop-section">
            <!-- „É©„Ç§„ÉñÈÖç‰ø°‰∏≠„Éê„ÉÉ„Ç∏ -->
            <div id="liveBadge" class="live-badge" style="display: none;">
                <span class="live-dot">‚óè</span>
                <span class="live-text">„É©„Ç§„ÉñÈÖç‰ø°‰∏≠ - AB„É´„Éº„Éó„ÅØ„Ç¢„Éº„Ç´„Ç§„ÉñÂæå„Å´ÊúÄÈÅ©Âåñ„Åï„Çå„Åæ„Åô</span>
            </div>
            <!-- „É´„Éº„Éó„Éà„Ç∞„É´ -->
            <div class="loop-header">
                <button id="loopToggleBtn" class="loop-toggle-btn" title="„É´„Éº„ÉóÂàáÊõø (L)">
                    <span class="loop-icon">‚Üª</span>
                    <span class="loop-text">„É´„Éº„Éó OFF</span>
                </button>
            </div>
            <div class="gap-control">
                <span id="gapCountdown" class="gap-countdown"></span>
                <span class="gap-label">Á©∫ÁôΩ</span>
                <div class="gap-buttons">
                    <button class="gap-btn active" data-gap="0">0</button>
                    <button class="gap-btn" data-gap="2">2</button>
                    <button class="gap-btn" data-gap="5">5</button>
                    <button class="gap-btn" data-gap="10">10</button>
                    <button class="gap-btn" data-gap="30">30</button>
                </div>
            </div>

            <!-- ABÂå∫Èñì„Ç∑„Éº„ÇØ„Éê„Éº -->
            <div class="ab-seekbar-container">
                <div id="abSeekbar" class="ab-seekbar">
                    <canvas id="waveformCanvas" class="ab-waveform"></canvas>
                    <div id="abRegion" class="ab-region"></div>
                    <div id="abCurrentPos" class="ab-current-pos"></div>
                    <div id="pointA" class="ab-point point-a">
                        <div class="point-handle top"></div>
                        <div class="point-line"></div>
                        <div class="point-handle bottom"></div>
                    </div>
                    <div id="pointB" class="ab-point point-b">
                        <div class="point-handle top"></div>
                        <div class="point-line"></div>
                        <div class="point-handle bottom"></div>
                    </div>
                </div>
            </div>

            <!-- ABË®≠ÂÆö„Ç´„Éº„Éâ -->
            <div class="ab-cards">
                <div class="ab-card card-a">
                    <div class="ab-card-header">
                        <span class="ab-label">A</span>
                        <span class="ab-card-title">ÈñãÂßã</span>
                        <button id="resetPointABtn" class="reset-point-btn" title="„É™„Çª„ÉÉ„Éà">‚úï</button>
                    </div>
                    <div class="ab-time-wrapper">
                        <input type="text" id="pointAInput" class="ab-time-input" placeholder="0:00.000" readonly>
                        <button class="ab-time-edit-btn" data-target="pointAInput" title="ÊôÇÈñì„ÇíÁ∑®ÈõÜ">‚úé</button>
                    </div>
                    <div class="ab-controls">
                        <button id="pointAMinus" class="step-btn" title="AÂú∞ÁÇπ„ÇíÊàª„Åô">‚àí</button>
                        <button id="pointAPlus" class="step-btn" title="AÂú∞ÁÇπ„ÇíÈÄ≤„ÇÅ„Çã">+</button>
                        <select id="stepSelectA" class="step-select" title="Ë™øÊï¥ÂπÖ">
                            <option value="0.001">0.001s</option>
                            <option value="0.01">0.01s</option>
                            <option value="0.1" selected>0.1s</option>
                            <option value="1">1s</option>
                        </select>
                        <button id="setPointABtn" class="set-current-btn" title="ÁèæÂú®„ÅÆÂÜçÁîü‰ΩçÁΩÆ„ÇíAÂú∞ÁÇπ„Å´Ë®≠ÂÆö (A)">ÁèæÂú®</button>
                    </div>
                </div>
                <div class="ab-card card-b">
                    <div class="ab-card-header">
                        <span class="ab-label">B</span>
                        <span class="ab-card-title">ÁµÇ‰∫Ü</span>
                        <button id="resetPointBBtn" class="reset-point-btn" title="„É™„Çª„ÉÉ„Éà">‚úï</button>
                    </div>
                    <div class="ab-time-wrapper">
                        <input type="text" id="pointBInput" class="ab-time-input" placeholder="0:00.000" readonly>
                        <button class="ab-time-edit-btn" data-target="pointBInput" title="ÊôÇÈñì„ÇíÁ∑®ÈõÜ">‚úé</button>
                    </div>
                    <div class="ab-controls">
                        <button id="pointBMinus" class="step-btn" title="BÂú∞ÁÇπ„ÇíÊàª„Åô">‚àí</button>
                        <button id="pointBPlus" class="step-btn" title="BÂú∞ÁÇπ„ÇíÈÄ≤„ÇÅ„Çã">+</button>
                        <select id="stepSelectB" class="step-select" title="Ë™øÊï¥ÂπÖ">
                            <option value="0.001">0.001s</option>
                            <option value="0.01">0.01s</option>
                            <option value="0.1" selected>0.1s</option>
                            <option value="1">1s</option>
                        </select>
                        <button id="setPointBBtn" class="set-current-btn" title="ÁèæÂú®„ÅÆÂÜçÁîü‰ΩçÁΩÆ„ÇíBÂú∞ÁÇπ„Å´Ë®≠ÂÆö (B)">ÁèæÂú®</button>
                    </div>
                </div>
            </div>

            <!-- „Ç¢„ÇØ„Ç∑„Éß„É≥„Éú„Çø„É≥ -->
            <div class="action-buttons">
                <button id="saveHistoryBtn" class="save-history-btn">
                    <span class="btn-icon">‚òÖ</span><span class="btn-label">Â±•Ê≠¥„Å´‰øùÂ≠ò</span>
                </button>
                <button id="shareBtn" class="share-btn" title="ABÂå∫Èñì„ÅÆÂÖ±ÊúâURL„Çí„Ç≥„Éî„Éº">
                    <span class="btn-icon">‚Üó</span><span class="btn-label">ÂÖ±Êúâ</span>
                </button>
            </div>
            </div>

            <!-- „Ç∑„Éß„Éº„Éà„Ç´„ÉÉ„ÉàÔºàÊ®™‰∏¶„Å≥ÊôÇÔºöright-panel„Å´Ë°®Á§∫Ôºâ -->
            <div class="shortcut-accordion shortcut-in-panel">
                <button class="shortcut-accordion-btn" data-shortcut-toggle>
                    <span class="shortcut-icon">‚å®</span>
                    <span class="shortcut-label">Keys</span>
                    <span class="accordion-arrow">‚ñº</span>
                </button>
                <div class="shortcut-accordion-content" data-shortcut-content>
                    <div class="shortcut-list-compact">
                        <div class="shortcut-item"><kbd>Space</kbd><span>ÂÜçÁîü</span></div>
                        <div class="shortcut-item"><kbd>‚Üê‚Üí</kbd><span>5Áßí</span></div>
                        <div class="shortcut-item"><kbd>A</kbd><span>AÂú∞ÁÇπ</span></div>
                        <div class="shortcut-item"><kbd>B</kbd><span>BÂú∞ÁÇπ</span></div>
                        <div class="shortcut-item"><kbd>L</kbd><span>„É´„Éº„Éó</span></div>
                        <div class="shortcut-item"><kbd>R</kbd><span>„É™„Çª„ÉÉ„Éà</span></div>
                        <div class="shortcut-item"><kbd>M</kbd><span>„Éü„É•„Éº„Éà</span></div>
                        <div class="shortcut-item"><kbd>F</kbd><span>ÂÖ®ÁîªÈù¢</span></div>
                        <div class="shortcut-item"><kbd>H</kbd><span>Â∑¶Âè≥ÂèçËª¢</span></div>
                        <div class="shortcut-item"><kbd>V</kbd><span>‰∏ä‰∏ãÂèçËª¢</span></div>
                    </div>
                </div>
            </div>
        </div>
        </div>

    </div>

    <!-- Â±•Ê≠¥„É¢„Éº„ÉÄ„É´ -->
    <div id="historyModal" class="history-modal">
        <div class="history-modal-content">
            <div class="history-modal-header">
                <h2>Â±•Ê≠¥</h2>
                <button id="closeHistoryBtn" class="history-close-btn">‚úï</button>
            </div>
            <div class="history-toolbar" id="historyToolbarNormal">
                <div class="toolbar-left">
                    <label id="historyImportBtn" class="toolbar-btn" title="JSON„Éï„Ç°„Ç§„É´„Åã„ÇâË™≠Ëæº">
                        <span class="toolbar-icon">‚Üì</span>
                        <span class="toolbar-label">Ë™≠Ëæº</span>
                        <input type="file" id="importHistoryInput" accept=".json" hidden>
                    </label>
                    <button id="exportSelectBtn" class="toolbar-btn" title="JSON„Éï„Ç°„Ç§„É´„Å´‰øùÂ≠ò">
                        <span class="toolbar-icon">‚Üë</span>
                        <span class="toolbar-label">‰øùÂ≠ò</span>
                    </button>
                </div>
                <button id="clearAllHistoryBtn" class="toolbar-btn-danger" title="ÂÖ®„Å¶„ÅÆÂ±•Ê≠¥„ÇíÂâäÈô§">
                    <span class="toolbar-label">ÂÖ®ÂâäÈô§</span>
                </button>
            </div>
            <div class="history-toolbar select-mode-toolbar" id="historyToolbarSelect" style="display: none;">
                <div class="toolbar-left">
                    <button id="selectAllBtn" class="toolbar-btn-sm">ÂÖ®ÈÅ∏Êäû</button>
                    <button id="deselectAllBtn" class="toolbar-btn-sm">Ëß£Èô§</button>
                    <span id="selectedCount" class="selected-count">0‰ª∂</span>
                </div>
                <div class="toolbar-right">
                    <button id="cancelSelectBtn" class="toolbar-btn-ghost">„Ç≠„É£„É≥„Çª„É´</button>
                    <button id="exportSelectedBtn" class="toolbar-btn-primary" disabled>‰øùÂ≠ò</button>
                </div>
            </div>
            <div id="historyList" class="history-list">
                <!-- Â±•Ê≠¥„Ç¢„Ç§„ÉÜ„É†„Åå„Åì„Åì„Å´ÂãïÁöÑ„Å´ËøΩÂä†„Åï„Çå„Çã -->
            </div>
        </div>
    </div>

    <!-- ‰Ωø„ÅÑÊñπ„É¢„Éº„ÉÄ„É´ -->
    <div id="helpModal" class="help-modal">
        <div class="help-modal-content">
            <div class="help-modal-header">
                <h2>‰Ωø„ÅÑÊñπ</h2>
                <button id="closeHelpBtn" class="help-close-btn">‚úï</button>
            </div>
            <div class="help-steps">
                <div class="help-step">
                    <span class="help-step-num">1</span>
                    <div class="help-step-text">
                        <strong>ÂãïÁîª„ÇíË™≠„ÅøËæº„ÇÄ</strong>
                        <span>YouTube URL„ÇíË≤º„Çä‰ªò„Åë„ÄÅ„Åæ„Åü„ÅØ„É≠„Éº„Ç´„É´ÂãïÁîª„Éï„Ç°„Ç§„É´„ÇíÈÅ∏Êäû</span>
                    </div>
                </div>
                <div class="help-step">
                    <span class="help-step-num">2</span>
                    <div class="help-step-text">
                        <strong>A„ÉªBÂú∞ÁÇπ„Çí„Çª„ÉÉ„Éà</strong>
                        <span>„É´„Éº„Éó„ÅÆÈñãÂßãÂú∞ÁÇπ(A)„Å®ÁµÇ‰∫ÜÂú∞ÁÇπ(B)„ÇíË®≠ÂÆö</span>
                    </div>
                </div>
                <div class="help-step">
                    <span class="help-step-num">3</span>
                    <div class="help-step-text">
                        <strong>„É´„Éº„ÉóON</strong>
                        <span>A-BÂå∫Èñì„ÇíÁπ∞„ÇäËøî„ÅóÂÜçÁîü</span>
                    </div>
                </div>
            </div>
            <div class="help-footer">
                <a href="https://github.com/kuronekorou39/u2b-loop" target="_blank" rel="noopener">GitHub</a>
            </div>
        </div>
    </div>

    <!-- „É≠„Éº„Ç´„É´„Éï„Ç°„Ç§„É´Âæ©ÂÖÉ„É¢„Éº„ÉÄ„É´ -->
    <div id="localRestoreModal" class="restore-modal">
        <div class="restore-modal-content">
            <p id="restoreModalMessage" class="restore-modal-message"></p>
            <p class="restore-modal-note">‚Äª„Éñ„É©„Ç¶„Ç∂„ÅÆÂà∂Èôê„Å´„Çà„Çä„Éï„Ç°„Ç§„É´„Éë„Çπ„ÅØ‰øùÊåÅ„Åß„Åç„Åæ„Åõ„Çì</p>
            <div class="restore-modal-buttons">
                <button id="restoreSelectFileBtn" class="restore-btn restore-btn-primary">„Éï„Ç°„Ç§„É´„ÇíÈÅ∏Êäû</button>
                <button id="restoreApplyOnlyBtn" class="restore-btn restore-btn-secondary" style="display: none;">Âå∫Èñì„Å†„ÅëÈÅ©Áî®</button>
                <button id="restoreCancelBtn" class="restore-btn restore-btn-cancel">„Ç≠„É£„É≥„Çª„É´</button>
            </div>
        </div>
    </div>

    <script src="https://www.youtube.com/iframe_api"></script>
    <script src="app.js"></script>
    <script>
        // Service Worker ÁôªÈå≤„Å®Êõ¥Êñ∞Ê§úÁü•
        if ('serviceWorker' in navigator) {
            let swRegistration = null;
            let updateFound = false;

            function checkForUpdate() {
                if (!swRegistration) return;

                updateFound = false;
                const statusEl = document.getElementById('versionStatus');
                statusEl.textContent = 'Á¢∫Ë™ç‰∏≠...';
                statusEl.className = 'version-status checking';

                swRegistration.update().then(() => {
                    // Â∞ë„ÅóÂæÖ„Å£„Å¶updatefound„ÅåÁô∫ÁÅ´„Åó„Å™„Åë„Çå„Å∞ÊúÄÊñ∞
                    setTimeout(() => {
                        if (!updateFound) {
                            statusEl.textContent = '(ÊúÄÊñ∞)';
                            statusEl.className = 'version-status latest';
                        }
                    }, 1500);
                }).catch(() => {
                    statusEl.textContent = '';
                    statusEl.className = 'version-status';
                });
            }

            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js')
                    .then((registration) => {
                        swRegistration = registration;

                        // Êõ¥Êñ∞Ê§úÂá∫ÊôÇÔºà„É¶„Éº„Ç∂„Éº„ÅåÊâãÂãï„ÅßÁ¢∫Ë™ç„Åó„ÅüÊôÇ„ÅÆ„ÅøÁô∫ÁÅ´Ôºâ
                        registration.addEventListener('updatefound', () => {
                            updateFound = true;
                            const statusEl = document.getElementById('versionStatus');
                            statusEl.textContent = '';
                            statusEl.className = 'version-status';

                            const newWorker = registration.installing;
                            newWorker.addEventListener('statechange', () => {
                                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                    // Êñ∞„Åó„ÅÑ„Éê„Éº„Ç∏„Éß„É≥„ÅåÂà©Áî®ÂèØËÉΩ - Êõ¥Êñ∞„É™„É≥„ÇØË°®Á§∫
                                    document.getElementById('updateLink').style.display = 'inline';
                                }
                            });
                        });
                    })
                    .catch((error) => {
                        console.error('Service WorkerÁôªÈå≤Â§±Êïó:', error);
                    });

                // „Éê„Éº„Ç∏„Éß„É≥„ÇØ„É™„ÉÉ„ÇØ„ÅßÊõ¥Êñ∞„ÉÅ„Çß„ÉÉ„ÇØÔºàÊâãÂãï„ÅÆ„ÅøÔºâ
                document.getElementById('appVersion').addEventListener('click', checkForUpdate);

                // Êõ¥Êñ∞„É™„É≥„ÇØ„ÅÆ„ÇØ„É™„ÉÉ„ÇØ„Åß„É™„É≠„Éº„Éâ
                document.getElementById('updateLink').addEventListener('click', (e) => {
                    e.preventDefault();
                    window.location.reload();
                });
            });
        }
    </script>
</body>
</html>
