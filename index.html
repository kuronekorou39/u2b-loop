<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#e94560">
    <meta name="description" content="YouTube & Local Video A-B Loop Player">
    <title>U2B-Loop</title>
    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" href="assets/logo.png" type="image/png">
    <link rel="apple-touch-icon" href="assets/logo.png">
</head>
<body>
    <div class="container">
        <!-- „Éò„ÉÉ„ÉÄ„ÉºÔºà„Çø„Ç§„Éà„É´ + „É¨„Ç§„Ç¢„Ç¶„ÉàÂàáÊõø + URLÂÖ•Âäõ„Éà„Ç∞„É´Ôºâ -->
        <header class="header">
            <a href="./" class="logo-link">
                <img src="assets/logo.png" alt="U2B-Loop" class="header-logo">
            </a>
            <div class="header-buttons">
                <button id="toggleUrlBtn" class="header-toggle show" title="ÂãïÁîª„ÇíË™≠„ÅøËæº„ÇÄ">
                    <span class="toggle-text">Ë™≠Ëæº</span>
                    <span class="toggle-arrow">‚ñº</span>
                </button>
                <button id="layoutBtn" class="header-btn" title="„É¨„Ç§„Ç¢„Ç¶„ÉàÂàáÊõø">
                    <span class="btn-icon">‚äü</span><span class="btn-label">‰∏¶Êõø</span>
                </button>
                <button id="historyBtn" class="header-btn" title="Â±•Ê≠¥">
                    <span class="btn-icon">‚ó∑</span><span class="btn-label">Â±•Ê≠¥</span>
                </button>
                <button id="themeBtn" class="header-btn" title="„ÉÜ„Éº„ÉûÂàáÊõø">
                    <span class="btn-icon">‚òÄ</span><span class="btn-label">Ëâ≤</span>
                </button>
                <!-- „Ç∑„Éß„Éº„Éà„Ç´„ÉÉ„ÉàÔºàÁ∏¶‰∏¶„Å≥ÊôÇÔºö„Éò„ÉÉ„ÉÄ„Éº„Å´Ë°®Á§∫Ôºâ -->
                <div class="shortcut-accordion shortcut-in-header">
                    <button id="shortcutAccordionBtn" class="header-btn shortcut-accordion-btn">
                        <span class="btn-icon">‚å®</span><span class="btn-label">Keys</span>
                    </button>
                    <div id="shortcutAccordionContent" class="shortcut-accordion-content">
                        <div class="shortcut-list-compact">
                            <div class="shortcut-item"><kbd>Space</kbd><span>ÂÜçÁîü</span></div>
                            <div class="shortcut-item"><kbd>‚Üê‚Üí</kbd><span>5Áßí</span></div>
                            <div class="shortcut-item"><kbd>A</kbd><span>AÂú∞ÁÇπ</span></div>
                            <div class="shortcut-item"><kbd>B</kbd><span>BÂú∞ÁÇπ</span></div>
                            <div class="shortcut-item"><kbd>L</kbd><span>„É´„Éº„Éó</span></div>
                            <div class="shortcut-item"><kbd>R</kbd><span>„É™„Çª„ÉÉ„Éà</span></div>
                            <div class="shortcut-item"><kbd>M</kbd><span>„Éü„É•„Éº„Éà</span></div>
                            <div class="shortcut-item"><kbd>F</kbd><span>ÂÖ®ÁîªÈù¢</span></div>
                            <div class="shortcut-item"><kbd>H</kbd><span>Â∑¶Âè≥ÂèçËª¢</span></div>
                            <div class="shortcut-item"><kbd>V</kbd><span>‰∏ä‰∏ãÂèçËª¢</span></div>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- ÂãïÁîªË™≠„ÅøËæº„ÅøÔºàÊäò„Çä„Åü„Åü„ÅøÔºâ -->
        <div id="urlSection" class="url-section show">
            <!-- YouTube -->
            <div class="source-row">
                <span class="source-label">YouTube</span>
                <input type="text" id="videoUrl" placeholder="URL„ÇíË≤º„Çä‰ªò„Åë">
                <button id="loadBtn" class="load-btn">Ë™≠Ëæº</button>
            </div>

            <!-- „É≠„Éº„Ç´„É´„Éï„Ç°„Ç§„É´ -->
            <div class="source-row">
                <span class="source-label">„Éï„Ç°„Ç§„É´</span>
                <label class="file-input-label">
                    <span id="fileNameDisplay">ÈÅ∏Êäû...</span>
                    <input type="file" id="localFileInput" accept="video/*" hidden>
                </label>
                <button id="loadFileBtn" class="load-btn">Ë™≠Ëæº</button>
            </div>
        </div>

        <!-- „É°„Ç§„É≥„Ç≥„É≥„ÉÜ„É≥„ÉÑÔºàÊ®™‰∏¶„Å≥ÂØæÂøúÔºâ -->
        <div class="main-content">
            <!-- Â∑¶„Éë„Éç„É´: ÂãïÁîª + „Ç≥„É≥„Éà„É≠„Éº„É´ -->
            <div class="left-panel">
                <!-- ÂãïÁîª„Éó„É¨„Éº„É§„Éº + „Ç™„Éº„Éê„Éº„É¨„Ç§„Ç≥„É≥„Éà„É≠„Éº„É©„Éº -->
                <div class="player-wrapper" id="playerWrapper">
                    <div id="playerContainer" class="player-container">
                        <div id="player"></div>
                        <video id="localVideo" style="display: none;"></video>
                    </div>

                    <!-- „Ç™„Éº„Éê„Éº„É¨„Ç§„Ç≥„É≥„Éà„É≠„Éº„É©„ÉºÔºà„Éï„É´„Çπ„ÇØ„É™„Éº„É≥ÊôÇÔºâ -->
                    <div class="overlay-controls" id="overlayControls">
                        <div class="overlay-gradient"></div>
                        <div class="overlay-content">
                            <!-- „Ç∑„Éº„ÇØ„Éê„Éº -->
                            <div class="overlay-seekbar">
                                <span id="overlayCurrentTime" class="overlay-time">0:00</span>
                                <div class="overlay-seekbar-wrapper">
                                    <div id="overlayABRegion" class="overlay-ab-region"></div>
                                    <input type="range" id="overlaySeekbar" class="overlay-seekbar-input" min="0" max="100" value="0" step="0.1">
                                </div>
                                <span id="overlayDuration" class="overlay-time">0:00</span>
                            </div>
                            <!-- „Éú„Çø„É≥È°û -->
                            <div class="overlay-buttons">
                                <button id="overlayPlayPauseBtn" class="overlay-btn play">‚ñ∂</button>
                                <button id="overlayMuteBtn" class="overlay-btn">üîä</button>
                                <select id="overlaySpeedSelect" class="overlay-select">
                                    <option value="0.25">0.25x</option>
                                    <option value="0.5">0.5x</option>
                                    <option value="0.75">0.75x</option>
                                    <option value="1" selected>1x</option>
                                    <option value="1.25">1.25x</option>
                                    <option value="1.5">1.5x</option>
                                    <option value="1.75">1.75x</option>
                                    <option value="2">2x</option>
                                </select>
                                <button id="overlayLoopBtn" class="overlay-btn">‚Üª OFF</button>
                                <button id="overlayExitBtn" class="overlay-btn exit">‚úï</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- „É°„Ç§„É≥„Ç∑„Éº„ÇØ„Éê„Éº + ÊôÇÈñì -->
                <div class="seekbar-section">
                    <span id="currentTime">0:00</span>
                    <div class="seekbar-wrapper">
                        <div id="seekbarABRegion" class="seekbar-ab-region"></div>
                        <input type="range" id="seekbar" min="0" max="100" value="0" step="0.1">
                    </div>
                    <span id="duration">0:00</span>
                </div>

                <!-- „Ç≥„É≥„Éà„É≠„Éº„É´Ë°åÔºöÂÜçÁîü + ÈÄüÂ∫¶ + „Éü„É•„Éº„Éà + ÂèçËª¢ -->
                <div class="controls-row">
                    <button id="playPauseBtn" class="play-btn">‚ñ∂</button>
                    <select id="speedSelect" title="ÂÜçÁîüÈÄüÂ∫¶">
                        <option value="0.25">0.25x</option>
                        <option value="0.5">0.5x</option>
                        <option value="0.75">0.75x</option>
                        <option value="1" selected>1x</option>
                        <option value="1.25">1.25x</option>
                        <option value="1.5">1.5x</option>
                        <option value="1.75">1.75x</option>
                        <option value="2">2x</option>
                    </select>
                    <button id="muteBtn" class="mute-btn" title="„Éü„É•„Éº„Éà">üîä</button>
                    <div class="flip-buttons">
                        <button id="flipHorizontalBtn" class="flip-btn" title="Â∑¶Âè≥ÂèçËª¢">‚Üî</button>
                        <button id="flipVerticalBtn" class="flip-btn" title="‰∏ä‰∏ãÂèçËª¢">‚Üï</button>
                    </div>
                    <button id="fullscreenBtn" class="fullscreen-btn" title="„Éï„É´„Çπ„ÇØ„É™„Éº„É≥">‚õ∂</button>
                    <button id="ytControlsBtn" class="yt-controls-btn" title="YT„Ç≥„É≥„Éà„É≠„Éº„É©„ÉºË°®Á§∫">üéõ</button>
                </div>
            </div>

            <!-- Âè≥„Éë„Éç„É´: A-BÂå∫Èñì„É´„Éº„Éó -->
            <div class="right-panel">
                <div class="loop-section">
            <!-- „É´„Éº„Éó„Éà„Ç∞„É´ -->
            <div class="loop-header">
                <button id="loopToggleBtn" class="loop-toggle-btn">
                    <span class="loop-icon">‚Üª</span>
                    <span class="loop-text">„É´„Éº„Éó OFF</span>
                </button>
            </div>
            <div class="gap-control">
                <span id="gapCountdown" class="gap-countdown"></span>
                <span class="gap-label">Á©∫ÁôΩ</span>
                <div class="gap-buttons">
                    <button class="gap-btn active" data-gap="0">0</button>
                    <button class="gap-btn" data-gap="2">2</button>
                    <button class="gap-btn" data-gap="5">5</button>
                    <button class="gap-btn" data-gap="10">10</button>
                    <button class="gap-btn" data-gap="30">30</button>
                </div>
            </div>

            <!-- ABÂå∫Èñì„Ç∑„Éº„ÇØ„Éê„Éº -->
            <div class="ab-seekbar-container">
                <div id="abSeekbar" class="ab-seekbar">
                    <div id="abRegion" class="ab-region"></div>
                    <div id="abCurrentPos" class="ab-current-pos"></div>
                    <div id="pointA" class="ab-point point-a"></div>
                    <div id="pointB" class="ab-point point-b"></div>
                </div>
            </div>

            <!-- ABË®≠ÂÆö„Ç´„Éº„Éâ -->
            <div class="ab-cards">
                <div class="ab-card card-a">
                    <div class="ab-card-header">
                        <span class="ab-label">A</span>
                        <span class="ab-card-title">ÈñãÂßã</span>
                        <button id="resetPointABtn" class="reset-point-btn" title="„É™„Çª„ÉÉ„Éà">‚úï</button>
                    </div>
                    <input type="text" id="pointAInput" class="ab-time-input" placeholder="0:00.000">
                    <div class="ab-controls">
                        <button id="pointAMinus" class="step-btn">‚àí</button>
                        <button id="pointAPlus" class="step-btn">+</button>
                        <select id="stepSelectA" class="step-select">
                            <option value="0.001">0.001s</option>
                            <option value="0.01">0.01s</option>
                            <option value="0.1" selected>0.1s</option>
                            <option value="1">1s</option>
                        </select>
                        <button id="setPointABtn" class="set-current-btn">ÁèæÂú®‰ΩçÁΩÆ</button>
                    </div>
                </div>
                <div class="ab-card card-b">
                    <div class="ab-card-header">
                        <span class="ab-label">B</span>
                        <span class="ab-card-title">ÁµÇ‰∫Ü</span>
                        <button id="resetPointBBtn" class="reset-point-btn" title="„É™„Çª„ÉÉ„Éà">‚úï</button>
                    </div>
                    <input type="text" id="pointBInput" class="ab-time-input" placeholder="0:00.000">
                    <div class="ab-controls">
                        <button id="pointBMinus" class="step-btn">‚àí</button>
                        <button id="pointBPlus" class="step-btn">+</button>
                        <select id="stepSelectB" class="step-select">
                            <option value="0.001">0.001s</option>
                            <option value="0.01">0.01s</option>
                            <option value="0.1" selected>0.1s</option>
                            <option value="1">1s</option>
                        </select>
                        <button id="setPointBBtn" class="set-current-btn">ÁèæÂú®‰ΩçÁΩÆ</button>
                    </div>
                </div>
            </div>

            <!-- Â±•Ê≠¥„Å´‰øùÂ≠ò -->
            <button id="saveHistoryBtn" class="save-history-btn">Â±•Ê≠¥„Å´‰øùÂ≠ò</button>
            </div>

            <!-- „Ç∑„Éß„Éº„Éà„Ç´„ÉÉ„ÉàÔºàÊ®™‰∏¶„Å≥ÊôÇÔºöright-panel„Å´Ë°®Á§∫Ôºâ -->
            <div class="shortcut-accordion shortcut-in-panel">
                <button class="shortcut-accordion-btn" data-shortcut-toggle>
                    <span class="shortcut-icon">‚å®</span>
                    <span class="shortcut-label">Keys</span>
                    <span class="accordion-arrow">‚ñº</span>
                </button>
                <div class="shortcut-accordion-content" data-shortcut-content>
                    <div class="shortcut-list-compact">
                        <div class="shortcut-item"><kbd>Space</kbd><span>ÂÜçÁîü</span></div>
                        <div class="shortcut-item"><kbd>‚Üê‚Üí</kbd><span>5Áßí</span></div>
                        <div class="shortcut-item"><kbd>A</kbd><span>AÂú∞ÁÇπ</span></div>
                        <div class="shortcut-item"><kbd>B</kbd><span>BÂú∞ÁÇπ</span></div>
                        <div class="shortcut-item"><kbd>L</kbd><span>„É´„Éº„Éó</span></div>
                        <div class="shortcut-item"><kbd>R</kbd><span>„É™„Çª„ÉÉ„Éà</span></div>
                        <div class="shortcut-item"><kbd>M</kbd><span>„Éü„É•„Éº„Éà</span></div>
                        <div class="shortcut-item"><kbd>F</kbd><span>ÂÖ®ÁîªÈù¢</span></div>
                        <div class="shortcut-item"><kbd>H</kbd><span>Â∑¶Âè≥ÂèçËª¢</span></div>
                        <div class="shortcut-item"><kbd>V</kbd><span>‰∏ä‰∏ãÂèçËª¢</span></div>
                    </div>
                </div>
            </div>
        </div>
        </div>

    </div>

    <!-- Â±•Ê≠¥„É¢„Éº„ÉÄ„É´ -->
    <div id="historyModal" class="history-modal">
        <div class="history-modal-content">
            <div class="history-modal-header">
                <h2>Â±•Ê≠¥</h2>
                <button id="closeHistoryBtn" class="history-close-btn">‚úï</button>
            </div>
            <div class="history-toolbar">
                <label class="history-import-btn">
                    üìÇ Ë™≠Ëæº
                    <input type="file" id="importHistoryInput" accept=".json" hidden>
                </label>
                <button id="exportSelectBtn" class="history-export-btn">üíæ ‰øùÂ≠ò</button>
                <button id="clearAllHistoryBtn" class="history-clear-btn">üóë ÂÖ®ÂâäÈô§</button>
            </div>
            <div class="history-toolbar select-mode-toolbar" style="display: none;">
                <div class="select-mode-left">
                    <button id="selectAllBtn" class="select-all-btn">ÂÖ®ÈÅ∏Êäû</button>
                    <button id="deselectAllBtn" class="select-all-btn">ÂÖ®Ëß£Èô§</button>
                </div>
                <span id="selectedCount" class="selected-count">0‰ª∂ÈÅ∏Êäû‰∏≠</span>
                <div class="select-mode-buttons">
                    <button id="cancelSelectBtn" class="select-cancel-btn">„Ç≠„É£„É≥„Çª„É´</button>
                    <button id="exportSelectedBtn" class="select-export-btn" disabled>‰øùÂ≠ò</button>
                </div>
            </div>
            <div id="historyList" class="history-list">
                <!-- Â±•Ê≠¥„Ç¢„Ç§„ÉÜ„É†„Åå„Åì„Åì„Å´ÂãïÁöÑ„Å´ËøΩÂä†„Åï„Çå„Çã -->
            </div>
        </div>
    </div>

    <script src="https://www.youtube.com/iframe_api"></script>
    <script src="app.js"></script>
    <script>
        // Service Worker ÁôªÈå≤
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js')
                    .then((registration) => {
                        console.log('U2B-Loop: Service Worker ÁôªÈå≤ÊàêÂäü');
                    })
                    .catch((error) => {
                        console.log('U2B-Loop: Service Worker ÁôªÈå≤Â§±Êïó:', error);
                    });
            });
        }
    </script>
</body>
</html>
